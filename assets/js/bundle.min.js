const nameInput=document.querySelector("#pseudo"),msgInput=document.querySelector("#msg"),checkButton=document.querySelector("#buttonInput"),messageContainer=document.querySelector(".touit_content"),formulaireInput=document.querySelector("#form");function addTouit(d,i){if(i){let e=document.createElement("article");e.className="touit";let t=document.createElement("p");t.className="touit_pseudo";d=document.createTextNode(d);t.appendChild(d),e.appendChild(t);let n=document.createElement("p");n.className="touit_message";i=document.createTextNode(i);n.appendChild(i),e.appendChild(n);let o=document.createElement("div");o.className="touit_icone_box";let s=document.createElement("button");s.className="like";let a=document.createElement("img");a.src="src/img/like.svg";let c=document.createElement("button");c.className="comment";let u=document.createElement("img");u.src="src/img/comment.svg";let m=document.createElement("button");m.className="close";let l=document.createElement("img");l.src="src/img/close.svg",o.appendChild(s),s.appendChild(a),o.appendChild(c),c.appendChild(u),o.appendChild(m),m.appendChild(l),e.appendChild(o),messageContainer.prepend(e),m.addEventListener("click",function(){messageContainer.removeChild(e)})}}function getTouit(t,n){const o=new XMLHttpRequest;o.open("GET","http://touiteur.cefim-formation.org/list",!0),o.addEventListener("readystatechange",function(){var e;o.readyState===XMLHttpRequest.DONE&&(200===o.status?(e=JSON.parse(o.responseText),console.log(e),t(e)):n(status))}),o.send()}function sendTouit(t,n,e,o){const s=new XMLHttpRequest;s.open("POST","http://touiteur.cefim-formation.org/send",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.addEventListener("readystatechange",function(){var e;s.readyState===XMLHttpRequest.DONE&&(200===s.status?(e=JSON.parse(s.responseText),console.log("reponse passe"),t(e),console.log("et Ã§a passe")):(n(status),console.log("aie")))});o="name="+e+"&message="+o;s.send(o)}formulaireInput.addEventListener("submit",function(e){e.preventDefault(),sendTouit(function(){console.log("coucou")},function(){console.log("coucou sEND")},nameInput.value,msgInput.value),getTouit(function(t){for(let e=0;e<t.messages.length;e++)addTouit(t.messages[e].name,t.messages[e].message)},function(){})}),getTouit(function(t){for(let e=0;e<t.messages.length;e++)addTouit(t.messages[e].name,t.messages[e].message)},function(){});